# 链路预测

- 秦晋琦     2018103664     2019年6月19日

---

[TOC]

## 问题背景

网络中的链路预测是指如何通过已知的网络结构等信息预测网络中尚未产生连边的两个节点之间产生连接的可能性。预测已经存在但尚未被发现的连接实际上是一种数据挖掘的过程，而对于未来可能出现的连边的预测则与网络演化相关。有关链路预测的研究方法总结如下：

![链路预测](C:\qin\Projects\dsjb_network\链路预测.png)

## 数据集介绍

（1）数据集

American College Football 网络. Newman 根据美国大学生足球联赛而创建的一个复杂的社会网络.该网络包含 115个节点和 616 条边,其中网络中的结点代表足球队,两个结点之间的边表示两只球队之间进行过一场比赛.参赛的115支大学生代表队被分为12个联盟。比赛的流程是联盟内部的球队先进行小组赛,然后再是联盟之间球队的比赛。这表明联盟内部的球队之间进行的比赛次数多于联盟之间的球队之间进行的比赛的次数.联盟即可表示为该网络的真实社区结构。

数据来源：M. Girvan and M. E. J. Newman, Proc. Natl. Acad. Sci. USA 99, 7821-7826 (2002).

（2）网络主要指标描述及可视化

| Dataset statistics             |       |
| ------------------------------ | ----- |
| Nodes                          | 115   |
| Edges                          | 613   |
| Average degree                 | 10.7  |
| Average clustering coefficient | 0.403 |
| Number of triangles            | 810   |
| Fraction of closed triangles   | 0.407 |
| Diameter                       | 4     |
| Radius                         | 3     |

![](C:\qin\Projects\dsjb_network\Figure_1.png)



## 链路预测方法简介

### 问题描述及评价方法

#### 1、问题描述

定义$G(V,E)$为一个无向网络，其中$V$为节点集，$E$为边集合，网络总节点数为$N$，边数为$M$，节点对全集为$U$，给定一种链路预测方法，对每对没有连边的节点对$(x,y)$赋予一个分数$S_{x,y}$，然后将所有未连边的节点对根据分数进行排序，排在最前面的节点对出现连边的概率最大。

#### 2、评价方法

为了测试算法的准确性，将已知连边集$E$分成训练集$E^T$和测试集$E^P$两部分，测试集提供了正确的标签，因此可以采用常用的监督学习的评价指标进行测试。

- AUC
  $$
  AUC = \frac{n' + 0.5 n''}{n}
  $$

- Precision

$$
Precision = \frac{m}{L}
$$

### 基于相似性的链路预测

#### 介绍

刻画节点相似性的方法有多种，最简单的就是利用节点的属性，比如人的年龄、性别、职业等。另一种思路是利用网络的结构信息，称为结构相似性。基于结构相似性的链路预测精度取决于该结构相似性的定义能否很好的抓住目标网络的结构特征。

#### 方法

##### 1、基于局部信息的相似性指标

- 共同邻居(CN)

$$
S_{xy} = | \Gamma(x) \cap \Gamma(y) |
$$

​      共同邻居方法通过两个节点所拥有的共同邻居数来代表节点的相似性

- **Jaccard**指标
  $$
  S_{xy} = \frac{| \Gamma(x) \cap \Gamma(y) |}{| \Gamma(x) \cup \Gamma(y) |}
  $$
  

  其中$\Gamma(x)$代表$x$的邻居集，$y$同理。

- **Adamic-Adar** 指标(AA)

$$
S_{xy}^{AA} = \sum_{z \in \Gamma(x) \cap \Gamma(y)} \frac{1}{log k_z}
$$

​		不是采用对公共邻居点简单计数的方法，而是对连接较少的近邻点赋予较大的权重。

- **Resource-Allocation** 指标(RA，资源分配指标)
  $$
  S_{xy}^{RA} = \sum_{z \in \Gamma(x) \cap \Gamma(y)} \frac{1}{k_z}
  $$
  

##### 对比

基于football数据集，按照4：1的比例划分训练集和测试集，对比这几种方法的Precision：

**注**：*(1) 主程序文件*：`./code/LinkPrediction.py`    *(2) 自定义算法实现*：`./code/algorithm_qin.py`

| Methods | Precision |
| ------- | --------- |
| CN      | 0.374     |
| Jaccard | 0.203     |
| AA      | 0.407     |
| RA      | 0.398     |

可以看出，不同的方法效果存在差异，这是因为特定的网络结构对不同方法的契合度不同。可以看出，AA和RA这两个指标对于描述这个网络的结构较为贴切。

##### 2、基于路径的相似性指标

- Katz指标

  Katz指标考虑的是所有的路径数，且对于短路径赋予较大的权重，而长路径赋予较小的权重，它的定义为：
  $$
  S = \beta A + \beta^2 A^2 + \beta^3 A^3 + ... = (I-\beta A)^{-1} - I
  $$
  其中$\beta$为权重衰减因子，为了保证数列的收敛性，$\beta$的取值必须小于邻接矩阵$A$最大特征值的倒数。

  这里我们取$\beta$为0.01.

##### 3、基于随机游走的相似性指标

- RWR

  重启的随机游走，简称RWR，该指标可以看成是网页排序算法(PageRank)的拓展。其假设随机游走粒子每走一步都以一定概率返回初始位置，设粒子返回概率为$1-c$，$P$为网络的马尔可夫转移矩阵，初始时刻粒子在节点$x$处，解得粒子到达各个节点的概率的稳态解为：
  $$
  q_x = (1-c)(I-cP^T)^{-1}e_x
  $$
  其中$q_{xy}$表示从节点$x$出发的粒子最终以多少的概率走到节点$y$，由此定义RWR相似度为：
  $$
  S_{xy}^{RWR} = q_{xy} + q_{yx}
  $$

##### 对比

| Methods | Precision |
| ------- | --------- |
| Katz    | 0.423     |
| RWR     | 0.455     |

这两个指标都是**全域指标**，考察的是网络整体的结构信息，而不是节点邻居等局部信息，虽然计算复杂度提高，但相比较而言，可以更好的利用网络的结构信息，因此也达到了更好的效果。



## 参考文献

[1] 吕琳媛. 复杂网络链路预测[J]. 电子科技大学学报, 2010, 39(5):651-661.

[2] M. Girvan and M. E. J. Newman, Proc. Natl. Acad. Sci. USA 99, 7821-7826 (2002).